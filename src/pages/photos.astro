---
import { getCollection } from "astro:content";
import { SITE } from "@config";
import Layout from "@layouts/Layout.astro";
import Main from "@layouts/Main.astro";
import Header from "@components/Header.astro";
import Footer from "@components/Footer.astro";
import fs from "fs";
import path from "path";

// 获取图片文件列表
const photosDir = "./public/imgs";
const photoFiles = fs.readdirSync(photosDir).filter(file => /\.(gif|jpg|jpeg|tiff|png|bmp|webp|avif|jxl)$/i.test(file));

// 对图片文件进行排序
photoFiles.sort((a, b) => b.localeCompare(a));

// 引入 React 和 Lightbox 组件
import React from 'react';
import { SlideshowLightbox } from 'lightbox.js-react';
import 'lightbox.js-react/dist/index.css';
---

<Layout title={`Gallery | ${SITE.title}`}>
  <Header activeNav="gallery" />
  <Main pageTitle="Gallery" pageDesc="Browse our photo gallery ...">
    <div class="gallery-photos page">
      <SlideshowLightbox className="container grid grid-cols-3 gap-2 mx-auto">
        {photoFiles.map((file, index) => (
          <img 
            key={index}
            className="w-full rounded" 
            loading='lazy' 
            decoding="async" 
            src={`/imgs/${file}`} 
            alt={file} 
          />
        ))}
      </SlideshowLightbox>
    </div>
  </Main>
  <Footer />
</Layout>
