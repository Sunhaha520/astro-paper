---
import { getCollection } from "astro:content";
import { SITE } from "@config";
import Layout from "@layouts/Layout.astro";
import Main from "@layouts/Main.astro";
import Header from "@components/Header.astro";
import Footer from "@components/Footer.astro";

// 图片链接数组
const photoLinks = [
  "https://r2.xiaoayu.eu.org/2024/10/925fa31c2abf1e95f9434b12a763e22f.webp",
  "https://r2.xiaoayu.eu.org/2024/10/2f54b82ca6f83af9f00e8e99dd705d0d.webp",
  "https://r2.xiaoayu.eu.org/2024/10/01cd76976e42b699fadd7dbb6f963eb3.webp",
  "https://r2.xiaoayu.eu.org/2024/10/a50d2c7c59a58b771b415962164d5e2c.webp",
  // 添加更多图片链接
];
---

<Layout title={`Gallery | ${SITE.title}`}>
  <Header activeNav="gallery" />
  <Main pageTitle="Gallery" pageDesc="Browse our photo gallery ...">
    <div class="gallery-photos page">
      {photoLinks.map((link, index) => (
        <div class="gallery-photo" data-index={index}>
          <img class="photo-img" loading='lazy' decoding="async" src={link} alt={`Photo ${index + 1}`} />
          <span class="photo-title">Photo {index + 1}</span>
          <span class="photo-time">2023-10-01</span>
        </div>
      ))}
    </div>
  </Main>
  <Footer />
</Layout>

<style>
.gallery-photos { width: 100%; display: flex; flex-wrap: wrap; }
.gallery-photo { width: 24.9%; position: relative; overflow: hidden; margin: 5px; }
.gallery-photo img { display: block; width: 100%; border-radius: 0; padding: 4px; cursor: pointer; transition: all .4s ease-in-out; }
.gallery-photo span.photo-title, .gallery-photo span.photo-time { background: rgba(0, 0, 0, 0.3); padding: 0px 8px; font-size: 0.9rem; color: #fff; display: none; }
.gallery-photo span.photo-title { position: absolute; bottom: 4px; left: 4px; }
.gallery-photo span.photo-time { position: absolute; top: 4px; left: 4px; font-size: 0.8rem; }
.gallery-photo:hover span.photo-title { display: block; }
.gallery-photo:hover img { transform: scale(1.1); }
@media screen and (max-width: 1280px) { .gallery-photo { width: 33.3%; } }
@media screen and (max-width: 860px) { .gallery-photo { width: 49.9%; } }
@media (max-width: 683px) { .photo-time { display: none; } }

/* Lightbox styles */
.lightbox { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.8); justify-content: center; align-items: center; z-index: 1000; }
.lightbox img { max-width: 80%; max-height: 80%; }
.lightbox.active { display: flex; }
</style>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const galleryPhotos = document.querySelector('.gallery-photos');
  const lightbox = document.createElement('div');
  lightbox.classList.add('lightbox');
  document.body.appendChild(lightbox);

  galleryPhotos.addEventListener('click', (event) => {
    if (event.target.classList.contains('photo-img')) {
      const index = event.target.parentElement.getAttribute('data-index');
      const imgSrc = photoLinks[index];
      const lightboxImg = document.createElement('img');
      lightboxImg.src = imgSrc;
      lightbox.innerHTML = '';
      lightbox.appendChild(lightboxImg);
      lightbox.classList.add('active');
    }
  });

  lightbox.addEventListener('click', () => {
    lightbox.classList.remove('active');
  });
});
</script>
